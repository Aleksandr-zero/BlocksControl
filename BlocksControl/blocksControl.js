"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var c=0;c<t.length;c++){var l=t[c];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function _createClass(e,t,c){return t&&_defineProperties(e.prototype,t),c&&_defineProperties(e,c),e}var WidthControl=function(){function WidthControl(e,t){_classCallCheck(this,WidthControl),this.container=e,this.options=t,this.blocks={},this.findsBlocks_In_Container(),this.sequenceNumbersBlocks=Object.keys(this.blocks),this.calculatesPositionBlocks_Window(),this.complementsOptions_Blocks(),this.addPercentScrolledPartOfPage(),this.calculatesFinalBlockWidth(),this.calculatesFinalBlockHeight(),this.calculatesNumber_For_ScrollingWindow_Block_OutOfSight()}return _createClass(WidthControl,[{key:"complementsOptions_Blocks",value:function complementsOptions_Blocks(){var c=this;this.sequenceNumbersBlocks.forEach(function(e){for(var t in c.options[e])c.blocks[e][t]=c.options[e][t]})}},{key:"addEventScrollForWindow",value:function addEventScrollForWindow(){var e=this;window.addEventListener("scroll",function(){e.checks_If_BlcokVisible({top:window.pageYOffset,bottom:window.pageYOffset+document.documentElement.clientHeight})})}},{key:"checks_If_BlcokVisible",value:function checks_If_BlcokVisible(t){var c=this;this.sequenceNumbersBlocks.forEach(function(e){if(t.top-c.blocks[e].block.clientHeight<=c.blocks[e].position.top&&c.blocks[e].position.top<t.bottom){if(c.calculatesWindowScrolling(e),c.blocks[e].isVisible)return;c.blocks[e].isVisible=!0}else c.blocks[e].isVisible&&(c.blocks[e].isVisible=!1)})}},{key:"calculatesWindowScrolling",value:function calculatesWindowScrolling(e){var t=(window.innerHeight-this.blocks[e].block.getBoundingClientRect().top)/this.blocks[1].percentScrollWindow;this.blocks[e].delayedLaunch&&this.blocks[e].delayedLaunch[0]&&t<this.blocks[e].delayedLaunch[1]||(this.setsPercentScrolledPartOfPage(e,t,[!1]),this.changeBlock(e,t))}},{key:"setsPercentScrolledPartOfPage",value:function setsPercentScrolledPartOfPage(e,t,c){100<=t||(c[0]?this.blocks[e].scrolledPartOfPage_For_DelayedLaunch=t-this.blocks[e].delayedLaunch[1]:this.blocks[e].delayedLaunch||c[0]||(this.blocks[e].scrolledPartOfPage=t))}},{key:"checks_If_PercentageNeedsChanged",value:function checks_If_PercentageNeedsChanged(e,t,c){this.blocks[e].delayedLaunchNumber!==t/(100/c)&&(this.blocks[e].delayedLaunchNumber=t/(100/c))}},{key:"findsBlocks_In_Container",value:function findsBlocks_In_Container(){var l=this,e=this.container.children;Array.prototype.forEach.call(e,function(e){for(var t,c=0;c<e.classList.length;c++)e.classList[c].includes("blocks-control-block")&&(t=(t=e.classList[c].split("-"))[t.length-1],l.blocks[t]={block:e},l.addProperty_IsVisible_Block(t))})}},{key:"addPercentScrolledPartOfPage",value:function addPercentScrolledPartOfPage(){var t=this;this.sequenceNumbersBlocks.forEach(function(e){t.blocks[e].scrolledPartOfPage=0})}},{key:"addProperty_IsVisible_Block",value:function addProperty_IsVisible_Block(e){this.blocks[e].isVisible=!1}},{key:"calculatesPositionBlocks_Window",value:function calculatesPositionBlocks_Window(){var c=this;this.sequenceNumbersBlocks.forEach(function(e){var t={top:Math.round(window.pageYOffset+c.blocks[e].block.getBoundingClientRect().top),bottom:Math.round(window.pageXOffset+c.blocks[e].block.getBoundingClientRect().bottom)};c.blocks[e].position=t})}},{key:"calculatesFinalBlockWidth",value:function calculatesFinalBlockWidth(){for(var e=0;e<this.sequenceNumbersBlocks.length;e++){var t,c,l=this.sequenceNumbersBlocks[e];"width"===this.blocks[l].actionProperty&&(t=0,c=this.blocks[l].block.clientWidth/100*this.blocks[l].percent,"enlarge"===this.blocks[l].action?t=this.blocks[l].block.clientWidth+c:"reduce"===this.blocks[l].action&&(t=this.blocks[l].block.clientWidth-c),this.blocks[l].finalWidth=t,this.blocks[l].initialWidth=this.blocks[l].block.clientWidth)}}},{key:"calculatesFinalBlockHeight",value:function calculatesFinalBlockHeight(){for(var e=0;e<this.sequenceNumbersBlocks.length;e++){var t,c,l=this.sequenceNumbersBlocks[e];"height"===this.blocks[l].actionProperty&&(t=0,c=this.blocks[l].block.clientHeight/100*this.blocks[l].percent,"enlarge"===this.blocks[l].action?t=this.blocks[l].block.clientHeight+c:"reduce"===this.blocks[l].action&&(t=this.blocks[l].block.clientHeight-c),this.blocks[l].finalHeight=t,this.blocks[l].initialHeight=this.blocks[l].block.clientHeight)}}},{key:"calculatesNumber_For_ScrollingWindow_Block_OutOfSight",value:function calculatesNumber_For_ScrollingWindow_Block_OutOfSight(){var c=this;this.sequenceNumbersBlocks.forEach(function(e){var t=window.innerHeight+c.blocks[e].block.getBoundingClientRect().height;c.blocks[e].percentScrollWindow=t/100})}},{key:"changeBlock",value:function changeBlock(e,t){var c,l=this.blocks[e].scrolledPartOfPage;this.blocks[e].delayedLaunch&&this.blocks[e].delayedLaunch[0]&&(l=this.blocks[e].scrolledPartOfPage_For_DelayedLaunch,this.checks_If_PercentageNeedsChanged(e,l,this.blocks[e].delayedLaunch[1]),this.blocks[e].scrolledPartOfPage=this.blocks[e].scrolledPartOfPage_For_DelayedLaunch+this.blocks[e].delayedLaunchNumber,l=this.blocks[e].scrolledPartOfPage,this.setsPercentScrolledPartOfPage(e,t,[!0,l])),"width"===this.blocks[e].actionProperty?(t=Math.abs(l*((this.blocks[e].finalWidth-this.blocks[e].initialWidth)/100)),c=this.blocks[e].initialWidth,"enlarge"===this.blocks[e].action?c+=t:"reduce"===this.blocks[e].action&&(c-=t),this.setsNewWidthForBlock(e,c)):"height"===this.blocks[e].actionProperty&&(c=Math.abs(l*((this.blocks[e].finalHeight-this.blocks[e].initialHeight)/100)),l=this.blocks[e].initialHeight,"enlarge"===this.blocks[e].action?l+=c:"reduce"===this.blocks[e].action&&(l-=c),this.setsNewHeightForBlock(e,l))}},{key:"setsNewWidthForBlock",value:function setsNewWidthForBlock(e,t){this.blocks[e].block.style.width="".concat(t,"px")}},{key:"setsNewHeightForBlock",value:function setsNewHeightForBlock(e,t){this.blocks[e].block.style.height="".concat(t,"px")}},{key:"run",value:function run(){this.addEventScrollForWindow()}}]),WidthControl}();